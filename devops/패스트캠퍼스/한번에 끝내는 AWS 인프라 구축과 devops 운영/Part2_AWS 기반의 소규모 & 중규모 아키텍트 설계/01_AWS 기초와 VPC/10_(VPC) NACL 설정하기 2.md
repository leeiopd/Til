# 패스트캠퍼스 - AWS 인프라 구축과 DevOps 운영 초격차 패키지

## Part2. AWS 기반 소규모 & 중규모 아키텍트 설계

### 01. AWS 기초와 VPC

#### 10_(VPC) NACL 설정하기 2



##### Public NACL Inbound/Outbound 실습 설정

* Inbound 설정

  |      | 규칙번호 | 유형        | 프로토콜 | 포트범위 | 소스      | 허용/거부 |
  | ---- | -------- | ----------- | -------- | -------- | --------- | --------- |
  | 추가 | 1        | 모든 TCP    | TCP(6)   | 모두     | 0.0.0.0/0 | Allow     |
  | 기존 | -        | 모든 트래픽 | 모두     | 모두     | 0.0.0.0/0 | Deny      |

* Oubound 설정

  |      | 규칙번호 | 유형        | 프로토콜 | 포트범위 | 소스      | 허용/거부 |
  | ---- | -------- | ----------- | -------- | -------- | --------- | --------- |
  | 추가 | 1        | 모든 TCP    | TCP(6)   | 모두     | 0.0.0.0/0 | Allow     |
  | 기존 | -        | 모든 트래픽 | 모두     | 모두     | 0.0.0.0/0 | Deny      |

* Public Subnet 설정

  * Public Subnet 자동 할당 IP 설정
    * 퍼블릭 IPv4 주소 자동 할당 활성화



#####  실습용 public EC2 생성

* 새 인스턴스 생성

  * 인스턴스 시작

    * 단계 1: Amazone Machine Image(AMI) 선택 - Amazone Linux 2 AMI / 64비트

    * 단계 2: 인스턴스 유형 선택 - t2.micro (프리티어 사용 가능)

    * 단계 3: 인스턴스 세부 정보 구성

      * 인스턴스 개수 - 1
      * 네트워크 - 실습용 fastcampus-vpc
      * 서브넷 - 실습용 fastcampus-subnet-public
      * 퍼블릭 IP 자동 할당 - 서브넷 사용 설정(활성화)
        * Public Subnet 설정: 퍼블릭 IPv4 주소 자동 할당 활성화
        * EC2 에 접근하기 위한 Public IP 주소를 할당 하는 설정
          * 인터넷에서 인스턴스에 연결할 수 있도록 Amazon의 퍼블릭 IP 주소 풀에서 퍼블릭 IP 주소를 요청
          * 대부분의 경우 퍼블릭 IP 주소는 중지되거나 종료되어 더 이상 사용할 수 없게 될 때까지 인스턴스와 연결된 상태로 유지
      * 사용자 데이터 - 입력
        * #!/bin/bash
          yum install httpd -y
          service httpd start

    * 단계 4: 스토리지 추가 - skip

    * 단계 5: 태그 추가

      | 키   | 값         | 인스턴스 | 볼륨 | 네트워크 인터페이스 |
      | ---- | ---------- | -------- | ---- | ------------------- |
      | Name | public_ec2 | v        | v    | v                   |

    * 단계 6: 보안 그룹 구성

      * 보안 그룹 할당 - 새 보안 그룹 생성
      * 보안 그룹 이름 - fastcampus_sg
      * 설명 - fastcampus_sg

      |      | 유형            | 프로토콜 | 포트범위 | 소스                        | 설명 |
      | ---- | --------------- | -------- | -------- | --------------------------- | ---- |
      | 기본 | SSH             | TCP      | 22       | 사용자 지정 - 0.0.0.0/0     |      |
      | 추가 | 사용자 지정 TCP | TCP      | 80       | 위치 무관 - 0.0.0.0/0, ::/0 |      |
      | 추가 | 사용자 지정 TCP | TCP      | 443      | 위치 무관 - 0.0.0.0/0, ::/0 |      |

    * 단계 7: 인스턴스 시작 검토 - skip

    * 시작

    * 기존 키 페어 선택 또는 새 키 페어 생성

      * 키 페어 생성 - fastcampus_devops.pem 파일 다운로드

* 인스턴스 생성 확인
  * 인스턴스의 퍼블릭 IPv4 주소를 browser 를 통해서 접속
  * Apache Test Page 확인 - 생성 완료





##### Inbound 규칙 추가

| 규칙번호 | 유형        | 프로토콜 | 포트범위 | 소스      | 허용/거부 |
| -------- | ----------- | -------- | -------- | --------- | --------- |
| 1        | HTTP(80)    | TCP(6)   | 80       | 0.0.0.0/0 | Deny      |
| 100      | 모든 TCP    | 모두     | 모두     | 0.0.0.0/0 | Allow     |
| -        | 모든 트래픽 | 모두     | 모두     | 0.0.0.0/0 | Deny      |

* IP 주소로 접근 불허